"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.version = exports.initGlobalStore = exports.createStore = exports.globalMixin = exports.injectStaff = void 0;
var mixin_1 = require("./mixin");
var store_1 = require("./store");
var version_1 = require("./version");
function hackPageBuilder() {
    var nativePage = Page;
    Page = function (options) {
        if (!options.data) {
            options.data = {};
        }
        if (!options.__mixin) {
            options.__mixin = {};
        }
        options = mixin_1._mixinGlobalObject(options);
        options = mixin_1.mixinCurrentPage(options);
        store_1.initStoreHacker(options);
        nativePage(options);
    };
}
function main() {
    hackPageBuilder();
    if (typeof wx !== 'undefined') {
        injectStaff(wx);
    }
    else if (typeof qq !== 'undefined') {
        injectStaff(qq);
    }
}
main();
function injectStaff(target) {
    target.mixin = mixin_1._globalMixin;
    target.createStore = store_1._createStore;
    target.initGlobalStore = store_1._initGlobalStore;
    target.mpMixinVersion = version_1.default;
}
exports.injectStaff = injectStaff;
exports.globalMixin = mixin_1._globalMixin;
exports.createStore = store_1._createStore;
exports.initGlobalStore = store_1._initGlobalStore;
exports.version = version_1.default;
var mpMixin = {
    globalMixin: exports.globalMixin,
    createStore: exports.createStore,
    initGlobalStore: exports.initGlobalStore,
    version: exports.version,
    injectStaff: injectStaff,
};
exports.default = {
    globalMixin: exports.globalMixin,
    createStore: exports.createStore,
    initGlobalStore: exports.initGlobalStore,
    version: exports.version,
    injectStaff: injectStaff,
    default: mpMixin,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFTQSxpQ0FBMkU7QUFDM0UsaUNBQXdFO0FBRXhFLHFDQUFpQztBQVNqQyxTQUFTLGVBQWU7SUFDcEIsSUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDO0lBQ3hCLElBQUksR0FBRyxVQUFVLE9BQW9CO1FBQ2pDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFO1lBQUUsT0FBTyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7U0FBRTtRQUN6QyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRTtZQUFDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1NBQUM7UUFFN0MsT0FBTyxHQUFHLDBCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXRDLE9BQU8sR0FBRyx3QkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVwQyx1QkFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXpCLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN4QixDQUFDLENBQUM7QUFDTixDQUFDO0FBRUQsU0FBUyxJQUFJO0lBQ1QsZUFBZSxFQUFFLENBQUM7SUFFbEIsSUFBSSxPQUFPLEVBQUUsS0FBSyxXQUFXLEVBQUU7UUFDM0IsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQ25CO1NBQU0sSUFBSSxPQUFPLEVBQUUsS0FBSyxXQUFXLEVBQUU7UUFDbEMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQ25CO0FBQ0wsQ0FBQztBQUVELElBQUksRUFBRSxDQUFDO0FBRVAsU0FBZ0IsV0FBVyxDQUFFLE1BSzVCO0lBQ0csTUFBTSxDQUFDLEtBQUssR0FBRyxvQkFBWSxDQUFDO0lBQzVCLE1BQU0sQ0FBQyxXQUFXLEdBQUcsb0JBQVksQ0FBQztJQUNsQyxNQUFNLENBQUMsZUFBZSxHQUFHLHdCQUFnQixDQUFDO0lBQzFDLE1BQU0sQ0FBQyxjQUFjLEdBQUcsaUJBQVEsQ0FBQztBQUNyQyxDQUFDO0FBVkQsa0NBVUM7QUFFWSxRQUFBLFdBQVcsR0FBRyxvQkFBWSxDQUFDO0FBQzNCLFFBQUEsV0FBVyxHQUFHLG9CQUFZLENBQUM7QUFDM0IsUUFBQSxlQUFlLEdBQUcsd0JBQWdCLENBQUM7QUFDbkMsUUFBQSxPQUFPLEdBQUcsaUJBQVEsQ0FBQztBQUVoQyxJQUFNLE9BQU8sR0FBRztJQUNaLFdBQVcscUJBQUE7SUFDWCxXQUFXLHFCQUFBO0lBQ1gsZUFBZSx5QkFBQTtJQUNmLE9BQU8saUJBQUE7SUFDUCxXQUFXLGFBQUE7Q0FDZCxDQUFDO0FBRUYsa0JBQWU7SUFDWCxXQUFXLHFCQUFBO0lBQ1gsV0FBVyxxQkFBQTtJQUNYLGVBQWUseUJBQUE7SUFDZixPQUFPLGlCQUFBO0lBQ1AsV0FBVyxhQUFBO0lBQ1gsT0FBTyxFQUFFLE9BQU87Q0FDbkIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IHRhY2tjaGVuXHJcbiAqIEBEYXRlOiAyMDIxLTA1LTAxIDE4OjI3OjAzXHJcbiAqIEBMYXN0RWRpdG9yczogdGhlYWphY2tcclxuICogQExhc3RFZGl0VGltZTogMjAyMS0wNS0wOCAyMTo1NDoyOVxyXG4gKiBARmlsZVBhdGg6IFxcbXAtbWl4aW5cXHNyY1xcaW5kZXgudHNcclxuICogQERlc2NyaXB0aW9uOiBDb2Rpbmcgc29tZXRoaW5nXHJcbiAqL1xyXG5cclxuaW1wb3J0IHtfZ2xvYmFsTWl4aW4sIG1peGluQ3VycmVudFBhZ2UsIF9taXhpbkdsb2JhbE9iamVjdH0gZnJvbSAnLi9taXhpbic7XHJcbmltcG9ydCB7X2NyZWF0ZVN0b3JlLCBfaW5pdEdsb2JhbFN0b3JlLCBpbml0U3RvcmVIYWNrZXJ9IGZyb20gJy4vc3RvcmUnO1xyXG5pbXBvcnQge0lQYWdlT3B0aW9uLCBJR2xvYmFsTWl4aW5GbiwgSUNyZWF0ZVN0b3JlRm4sIElJbml0R2xvYmFsU3RvcmVGbn0gZnJvbSAnLi90eXBlJztcclxuaW1wb3J0IF92ZXJzaW9uIGZyb20gJy4vdmVyc2lvbic7XHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgICBsZXQgUGFnZTogKG9wdGlvbnM6IElQYWdlT3B0aW9uKSA9PiB2b2lkO1xyXG4gICAgY29uc3Qgd3g6IG9iamVjdDtcclxuICAgIGNvbnN0IHFxOiBvYmplY3Q7XHJcbn1cclxuXHJcbi8vIOazqOWFpeS4gOS6m+WFqOWxgOaWueazlVxyXG5mdW5jdGlvbiBoYWNrUGFnZUJ1aWxkZXIgKCkge1xyXG4gICAgY29uc3QgbmF0aXZlUGFnZSA9IFBhZ2U7XHJcbiAgICBQYWdlID0gZnVuY3Rpb24gKG9wdGlvbnM6IElQYWdlT3B0aW9uKSB7XHJcbiAgICAgICAgaWYgKCFvcHRpb25zLmRhdGEpIHsgb3B0aW9ucy5kYXRhID0ge307IH1cclxuICAgICAgICBpZiAoIW9wdGlvbnMuX19taXhpbikge29wdGlvbnMuX19taXhpbiA9IHt9O31cclxuICAgIFxyXG4gICAgICAgIG9wdGlvbnMgPSBfbWl4aW5HbG9iYWxPYmplY3Qob3B0aW9ucyk7XHJcbiAgICBcclxuICAgICAgICBvcHRpb25zID0gbWl4aW5DdXJyZW50UGFnZShvcHRpb25zKTtcclxuXHJcbiAgICAgICAgaW5pdFN0b3JlSGFja2VyKG9wdGlvbnMpO1xyXG5cclxuICAgICAgICBuYXRpdmVQYWdlKG9wdGlvbnMpO1xyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gbWFpbiAoKSB7XHJcbiAgICBoYWNrUGFnZUJ1aWxkZXIoKTtcclxuICBcclxuICAgIGlmICh0eXBlb2Ygd3ggIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgaW5qZWN0U3RhZmYod3gpO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcXEgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgaW5qZWN0U3RhZmYocXEpO1xyXG4gICAgfVxyXG59XHJcblxyXG5tYWluKCk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0U3RhZmYgKHRhcmdldDogb2JqZWN0ICYge1xyXG4gIG1peGluPzogSUdsb2JhbE1peGluRm47XHJcbiAgY3JlYXRlU3RvcmU/OiBJQ3JlYXRlU3RvcmVGbjtcclxuICBpbml0R2xvYmFsU3RvcmU/OiBJSW5pdEdsb2JhbFN0b3JlRm47XHJcbiAgbXBNaXhpblZlcnNpb24/OiBzdHJpbmc7XHJcbn0pIHtcclxuICAgIHRhcmdldC5taXhpbiA9IF9nbG9iYWxNaXhpbjtcclxuICAgIHRhcmdldC5jcmVhdGVTdG9yZSA9IF9jcmVhdGVTdG9yZTtcclxuICAgIHRhcmdldC5pbml0R2xvYmFsU3RvcmUgPSBfaW5pdEdsb2JhbFN0b3JlO1xyXG4gICAgdGFyZ2V0Lm1wTWl4aW5WZXJzaW9uID0gX3ZlcnNpb247XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnbG9iYWxNaXhpbiA9IF9nbG9iYWxNaXhpbjtcclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVN0b3JlID0gX2NyZWF0ZVN0b3JlO1xyXG5leHBvcnQgY29uc3QgaW5pdEdsb2JhbFN0b3JlID0gX2luaXRHbG9iYWxTdG9yZTtcclxuZXhwb3J0IGNvbnN0IHZlcnNpb24gPSBfdmVyc2lvbjtcclxuXHJcbmNvbnN0IG1wTWl4aW4gPSB7XHJcbiAgICBnbG9iYWxNaXhpbixcclxuICAgIGNyZWF0ZVN0b3JlLFxyXG4gICAgaW5pdEdsb2JhbFN0b3JlLFxyXG4gICAgdmVyc2lvbixcclxuICAgIGluamVjdFN0YWZmLFxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gICAgZ2xvYmFsTWl4aW4sXHJcbiAgICBjcmVhdGVTdG9yZSxcclxuICAgIGluaXRHbG9iYWxTdG9yZSxcclxuICAgIHZlcnNpb24sXHJcbiAgICBpbmplY3RTdGFmZixcclxuICAgIGRlZmF1bHQ6IG1wTWl4aW4sIC8vIOWvueS6juW+ruS/oXRz57yW6K+R55qEIGRlZmF1bHQg55qE5YW85a65XHJcbn07Il19